<div fxLayout fxLayoutAlign="start start" fxLayout="row wrap">

  <mat-card fxFlex="100%" class="single_leftright single_top">
    <ngx-loading [show]="!(currentData && config)"></ngx-loading>
    <mat-card-header>
      <ion-icon color="primary" mat-card-avatar name="today"></ion-icon>
      <!-- <mat-icon mat-card-avatar>format_list_bulleted</mat-icon> -->
      <mat-card-title translate>Edge.Overview.Energytable.Title</mat-card-title>
    </mat-card-header>
  </mat-card>

  <ng-container *ngIf="currentData && config">

    <!-- Storage -->
    <mat-card class="single_leftright" fxFlex="100%">
      <mat-card-header>
        <img src="assets/img/storage.png" mat-card-avatar/>
        <mat-card-title translate>General.StorageSystem</mat-card-title>
      </mat-card-header>
      <mat-card-content *ngIf="currentData.summary.storage as sum">
        <table class="full_width">
          <tr class="underline">
            <td style="width:50%" translate>General.Soc</td>
            <td style="width:15%"></td>
            <td style="width:25%" class="align_right">{{ sum.soc }}</td>
            <td style="width:10%">%</td>
          </tr>
          <!-- DC -->
          <tr *ngIf="sum.chargeActivePowerDC != null">
            <td>
              <span translate>General.ChargePower</span> DC</td>
            <td></td>
            <td class="align_right">{{ sum.chargeActivePowerDC | number:'1.0-0' }}</td>
            <td>W</td>
          </tr>
          <!-- Symmetric ESS -->
          <ng-container *ngIf="sum.isAsymmetric == false && sum.chargeActivePowerAC != null && sum.dischargeActivePowerAC != null">
            <tr>
              <td translate>General.ChargePower
                <span *ngIf="sum.hasDC"> AC</span>
              </td>
              <td></td>
              <ng-container *ngIf="sum.chargeActivePowerAC != 0; else empty">
                <td class="align_right">{{ sum.chargeActivePowerAC | number:'1.0-0' }}</td>
                <td>W</td>
              </ng-container>
              <ng-template #empty>
                <td class="align_right">-</td>
                <td></td>
              </ng-template>
            </tr>
            <tr>
              <td translate>General.DischargePower
                <span *ngIf="sum.hasDC"> AC</span>
              </td>
              <td></td>
              <ng-container *ngIf="sum.dischargeActivePowerAC != 0; else empty">
                <td class="align_right">{{ sum.dischargeActivePowerAC | number:'1.0-0' }}</td>
                <td>W</td>
              </ng-container>
              <ng-template #empty>
                <td class="align_right">-</td>
                <td></td>
              </ng-template>
            </tr>
          </ng-container>
          <!-- Asymmetric ESS -->
          <ng-container *ngIf="sum.isAsymmetric == true && sum.chargeActivePowerACL1 != null && sum.dischargeActivePowerACL1 != null">
            <tr>
              <td translate>General.ChargePower
                <span *ngIf="sum.hasDC"> AC</span>
              </td>
              <td>L1</td>
              <td class="align_right">{{ sum.chargeActivePowerACL1 }}</td>
              <td>W</td>
            </tr>
            <tr *ngIf="sum.chargeActivePowerACL2 != null">
              <td></td>
              <td>L2</td>
              <td class="align_right">{{ sum.chargeActivePowerACL2 }}</td>
              <td>W</td>
            </tr>
            <tr *ngIf="sum.chargeActivePowerACL3 != null" class="underline">
              <td></td>
              <td>L3</td>
              <td class="align_right">{{ sum.chargeActivePowerACL3 }}</td>
              <td>W</td>
            </tr>
            <tr>
              <td translate>General.DischargePower
                <span *ngIf="sum.hasDC"> AC</span>
              </td>
              <td>L1</td>
              <td class="align_right">{{ sum.dischargeActivePowerACL1 }}</td>
              <td>W</td>
            </tr>
            <tr *ngIf="sum.dischargeActivePowerACL2 != null">
              <td></td>
              <td>L2</td>
              <td class="align_right">{{ sum.dischargeActivePowerACL2 }}</td>
              <td>W</td>
            </tr>
            <tr *ngIf="sum.dischargeActivePowerACL3 != null">
              <td></td>
              <td>L3</td>
              <td class="align_right">{{ sum.dischargeActivePowerACL3 }}</td>
              <td>W</td>
            </tr>
          </ng-container>
        </table>
      </mat-card-content>
    </mat-card>

    <!-- Grid -->
    <mat-card class="single_leftright" fxFlex="100%">
      <mat-card-header>
        <img src="assets/img/grid.png" mat-card-avatar/>
        <mat-card-title translate>General.Grid</mat-card-title>
      </mat-card-header>
      <mat-card-content *ngIf="currentData.summary.grid as sum">
        <table class="full_width">
          <tr>
            <td translate>General.GridBuy</td>
            <td></td>
            <ng-container *ngIf="sum.buyActivePower != 0; else empty">
              <td class="align_right">{{ sum.buyActivePower | number:'1.0-0' }}</td>
              <td>W</td>
            </ng-container>
            <ng-template #empty>
              <td class="align_right">-</td>
              <td></td>
            </ng-template>
          </tr>
          <tr>
            <td translate>General.GridSell</td>
            <td></td>
            <ng-container *ngIf="sum.sellActivePower != 0; else empty">
              <td class="align_right">{{ sum.sellActivePower | number:'1.0-0' }}</td>
              <td>W</td>
            </ng-container>
            <ng-template #empty>
              <td class="align_right">-</td>
              <td></td>
            </ng-template>
          </tr>
        </table>
      </mat-card-content>
    </mat-card>

    <!-- Production -->
    <mat-card class="single_leftright" fxFlex="100%">
      <mat-card-header>
        <img src="assets/img/production.png" mat-card-avatar/>
        <mat-card-title translate>General.Production</mat-card-title>
      </mat-card-header>
      <mat-card-content *ngIf="currentData.summary.production as sum">
        <table class="full_width">
          <!-- DC -->
          <tr *ngIf="sum.hasDC != null">
            <td style="width:50%">
              <span translate>General.Production</span> DC</td>
            <td style="width:25%" class="align_right">{{ sum.activePowerDC | number:'1.0-0' }}</td>
            <td style="width:10%">W</td>
          </tr>
          <!-- Symmetric Meter -->
          <ng-container *ngIf="sum.isAsymmetric == false && sum.activePowerAC != null">
            <tr>
              <td style="width:50%" translate>General.Production
                <span *ngIf="currentData.summary.storage.hasDC"> AC</span>
              </td>
              <ng-container *ngIf="sum.activePowerAC != 0; else empty">
                <td style="width:25%" class="align_right">{{ sum.activePowerAC | number:'1.0-0' }}</td>
                <td style="width:10%">W</td>
              </ng-container>
              <ng-template #empty>
                <td style="width:25%" class="align_right">-</td>
                <td style="width:10%"></td>
              </ng-template>
            </tr>
          </ng-container>
        </table>
      </mat-card-content>
    </mat-card>

    <!-- Consumption -->
    <mat-card class="single_leftright" fxFlex="100%">
      <mat-card-header>
        <img src="assets/img/consumption.png" mat-card-avatar/>
        <mat-card-title translate>General.Consumption</mat-card-title>
      </mat-card-header>
      <mat-card-content *ngIf="currentData.summary.consumption as sum">
        <table class="full_width">
          <tr>
            <td style="width:50%" translate>General.Power</td>
            <ng-container *ngIf="sum.activePower != 0; else empty">
              <td style="width:25%" class="align_right">{{ sum.activePower | number:'1.0-0' }}</td>
              <td style="width:10%">W</td>
            </ng-container>
            <ng-template #empty>
              <td style="width:25%" class="align_right">-</td>
              <td style="width:10%"></td>
            </ng-template>
          </tr>
        </table>
      </mat-card-content>
    </mat-card>
  </ng-container>
</div>